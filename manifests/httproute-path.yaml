# Path-based routing on a single hostname
#   demo.localhost/v1  ->  whoami-v1
#   demo.localhost/v2  ->  whoami-v2
#
# Both rules live in a single HTTPRoute resource.  The most-specific path
# match wins, so /v1 and /v2 are routed independently even though they share
# the same listener hostname.
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: whoami-path
  namespace: demo
spec:
  parentRefs:
    - name: traefik-gateway
      namespace: traefik
  hostnames:
    - "demo.localhost"
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /v1
      backendRefs:
        - name: whoami-v1
          port: 80
    - matches:
        - path:
            type: PathPrefix
            value: /v2
      backendRefs:
        - name: whoami-v2
          port: 80
