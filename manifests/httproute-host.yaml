# Hostname-based routing
# whoami.localhost -> whoami-v1 service
#
# This HTTPRoute lives in the "demo" namespace but attaches to the
# "traefik-gateway" Gateway in the "traefik" namespace.  This cross-namespace
# attachment is permitted because the Gateway was created with
# namespacePolicy: All (allowedRoutes.namespaces.from: All).
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: whoami-host
  namespace: demo
spec:
  parentRefs:
    - name: traefik-gateway
      namespace: traefik
  hostnames:
    - "whoami.localhost"
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - name: whoami-v1
          port: 80
